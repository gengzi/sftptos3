### 功能点
* 支持用户管理，管理用户，添加，删除，修改  --待实现
* 支持不同用户访问不同文件系统（本地或者s3） 甚至虚拟的文件系统   --代实现
* 支持用户设置属于自己的根目录，只能访问其下面的内容  
* 支持sftp服务监控，检测当前链接数，检测当前用户使用情况   -- 代实现
* 支持用户自定义访问s3文件系统代码实现，兼容各种s3存储













### 问题点
* 创建空目录，删除后。在父目录调用listobject 依然存在
```angular2html
问题原因：
实际删除空目录时，删除的是之前创建的空字节对象（xx/yy/ 类似这样的），其实已经删除了
但是使用的是minio测试的，发现删除空字节对象删除成功，但是listobject 仍然存在，导致还能获取到的该目录
使用minio点击删除，发现也不会删除掉
可能使用其他的s3文件系统不会存在该问题
```



### 优化
* 问题1：java.util.concurrent.ExecutionException: software.amazon.awssdk.core.exception.SdkClientException: Unable to execute HTTP request: Java heap space (SDK Attempt Count: 1)
```
优化点：
1，堆内存溢出，使用直接内存（堆外内存需要手动移除） ,
2，限制并发读取数
3，增加堆内存
4，修改缓存的内容大小，分片数。更少更小的内存占用（但是会调用s3api更多）
```
* 问题2：sftp下载文件默认大小为32kb，这样会导致从s3下载文件时会每次都读取32kb数据，会频繁调用s3
```angular2html
优化点：
预先读取缓存到内存中，每次读取缓存中的数据，当缓存中的数据不够时，再从s3下载数据
```

* 问题3：当s3某个相同key前缀存放太多文件时（可以简单理解为某个目录下存放了大量的文件），在sftp操作时会频繁获取某个对象的属性信息（大小，
是否为文件，等信息）会频繁调用s3api
```angular2html
优化点：
1，使用缓存，缓存对象信息，缓存对象内容，缓存对象列表信息，在操作删除，重命名，写入等操作时再移除缓存
2，在获取文件或者目录属性时，判断是目录时，会调用s3，把目录作为前缀扫描目录下有什么文件或者目录前缀，
在这个过程中已经获取到该目录下的元素的信息。所有也会把这部分数据进行缓存
```
* 问题4：从s3获取的目录前缀的对象时，会在“路径”后添加一个 /，这样会导致一部分sftp客户端获取目录失败（winscp）
```angular2html
优化点：
在获取s3对象列表时，将 / 移除
```
* 问题5：因为目录时空字节对象创建的，导致调用s3 listobject时响应结果中在object的节点下会发现该空字节对象，但是实际上在sftp实际为一个目录
```angular2html
优化点：
针对空字节对象单独处理，将其缓存为目录
```
* 问题6：上传文件时，临时目录创建的文件并没有删除掉。可能是上传一半不上传，或者报异常了。
```angular2html
优化点：调整为上传s3报异常，依然删除临时本地文件
```
* 问题7: 发现force() 方法，在sftp执行时会调用，此方法也会上传文件到s3.如果发生异常，后续channel的colse就不执行了
```angular2html
优化点：
1，在sftp执行force()方法时，上传文件到s3，如果发生异常，将异常捕获不抛出
```