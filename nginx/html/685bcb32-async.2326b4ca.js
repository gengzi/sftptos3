(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]||[]).push([["685bcb32"],{"7c6e4df5":function(e,a,s){s.d(a,"__esModule",{value:!0}),s.e(a,{default:function(){return E;}});var t=s("777fffbe"),n=s("852bbaa9"),l=s("452b4f57"),r=s("8946f00a"),d=n._(r),c=s("2871fbcf"),i=t._(c),o=s("d800230b"),g=t._(o),u=s("0e3da803"),m=t._(u),f=s("62f61479"),p=t._(f),M=s("92c451dd"),h=t._(M),y=s("d3c8d289"),x=t._(y),b=s("522048d4"),S=t._(b),j=s("8437ad0c"),k=s("27794ade"),I=s("9f383c56"),T=t._(I),K=s("3c2c85c4"),_=t._(K),v=s("0c02d634"),C=t._(v),N=s("100b90d1"),B=t._(N);let w=({visible:e,initialValues:a,onFinish:s,onCancel:t})=>{let[n]=_.default.useForm(),r=(0,k.useIntl)();return d.default.useEffect(()=>{e&&(a?n.setFieldsValue(a):n.resetFields());},[e,a,n]),(0,l.jsx)(T.default,{title:a?r.formatMessage({id:"pages.s3Management.editModalTitle"}):r.formatMessage({id:"pages.s3Management.addModalTitle"}),open:e,onCancel:t,footer:null,width:600,children:(0,l.jsxs)(_.default,{form:n,onFinish:e=>{s(e),n.resetFields();},labelCol:{span:6},wrapperCol:{span:16},children:[a&&(0,l.jsx)(B.default,{message:r.formatMessage({id:"pages.s3Management.configEffectDescription"}),description:r.formatMessage({id:"pages.s3Management.configEffectDetails"}),type:"info",showIcon:!0,style:{marginBottom:16}}),(0,l.jsx)(_.default.Item,{label:r.formatMessage({id:"pages.s3Management.nameLabel"}),name:"s3Name",rules:[{required:!0,message:r.formatMessage({id:"pages.s3Management.pleaseInputName"})}],children:(0,l.jsx)(C.default,{placeholder:r.formatMessage({id:"pages.s3Management.placeholderName"}),disabled:!!a})}),(0,l.jsx)(_.default.Item,{label:r.formatMessage({id:"pages.s3Management.endpointLabel"}),name:"endpoint",rules:[{required:!0,message:r.formatMessage({id:"pages.s3Management.pleaseInputEndpoint"})}],children:(0,l.jsx)(C.default,{placeholder:r.formatMessage({id:"pages.s3Management.placeholderEndpoint"})})}),(0,l.jsx)(_.default.Item,{label:r.formatMessage({id:"pages.s3Management.accessKeyLabel"}),name:"accessKey",rules:[{required:!0,message:r.formatMessage({id:"pages.s3Management.pleaseInputAccessKey"})}],children:(0,l.jsx)(C.default,{placeholder:r.formatMessage({id:"pages.s3Management.placeholderAccessKey"})})}),(0,l.jsx)(_.default.Item,{label:r.formatMessage({id:"pages.s3Management.secretKeyLabel"}),name:"accessSecret",rules:[{required:!0,message:r.formatMessage({id:"pages.s3Management.pleaseInputSecretKey"})}],children:(0,l.jsx)(C.default.Password,{placeholder:r.formatMessage({id:"pages.s3Management.placeholderSecretKey"})})}),(0,l.jsx)(_.default.Item,{label:r.formatMessage({id:"pages.s3Management.bucketLabel"}),name:"bucket",rules:[{required:!0,message:r.formatMessage({id:"pages.s3Management.pleaseInputBucket"})}],children:(0,l.jsx)(C.default,{placeholder:r.formatMessage({id:"pages.s3Management.placeholderBucket"})})}),(0,l.jsx)(_.default.Item,{label:r.formatMessage({id:"pages.s3Management.regionLabel"}),name:"region",tooltip:r.formatMessage({id:"pages.s3Management.regionTooltip"}),children:(0,l.jsx)(C.default,{placeholder:r.formatMessage({id:"pages.s3Management.placeholderRegion"})})}),(0,l.jsx)(_.default.Item,{wrapperCol:{offset:6,span:16},children:(0,l.jsxs)(g.default,{children:[(0,l.jsx)(i.default,{type:"primary",htmlType:"submit",children:a?r.formatMessage({id:"pages.s3Management.updateButtonText"}):r.formatMessage({id:"pages.s3Management.addButtonText"})}),(0,l.jsx)(i.default,{onClick:t,children:r.formatMessage({id:"pages.s3Management.cancelButtonText"})})]})})]})});};var q=s("b47c351f");let E=()=>{let[e,a]=(0,d.useState)(!1),[s,t]=(0,d.useState)(null),n=(0,d.useRef)(),r=(0,k.useIntl)(),c=async e=>{try{let a=await (0,q.queryS3Storages)({s3Name:e.s3Name,page:e.current?e.current-1:0,size:e.pageSize||10,sort:e.sort||"createTime"});if(a.success)return{data:a.data.map(e=>({...e,secretKey:e.accessSecret})),success:!0,total:a.total};return m.default.error(a.message||"\u83B7\u53D6S3\u914D\u7F6E\u5217\u8868\u5931\u8D25"),{data:[],success:!1,total:0};}catch(e){return m.default.error("\u83B7\u53D6S3\u914D\u7F6E\u5217\u8868\u5931\u8D25"),{data:[],success:!1,total:0};}},o=async e=>{try{let s={s3Name:e.s3Name,endpoint:e.endpoint,accessKey:e.accessKey,accessSecret:e.accessSecret,bucket:e.bucket,region:e.region},t=await (0,q.createS3Storage)(s);t.success?(m.default.success("\u6DFB\u52A0S3\u914D\u7F6E\u6210\u529F"),a(!1),n.current&&n.current.reload()):m.default.error(t.message||"\u6DFB\u52A0S3\u914D\u7F6E\u5931\u8D25");}catch(e){m.default.error("\u6DFB\u52A0S3\u914D\u7F6E\u5931\u8D25");}},u=async e=>{try{let t={s3Name:e.s3Name,endpoint:e.endpoint,accessKey:e.accessKey,accessSecret:e.accessSecret,bucket:e.bucket,region:e.region,id:null==s?void 0:s.id};if(s&&s.id){let e=await (0,q.updateS3Storage)(t);e.success?(m.default.success("\u7F16\u8F91S3\u914D\u7F6E\u6210\u529F"),a(!1),n.current&&n.current.reload()):m.default.error(e.message||"\u7F16\u8F91S3\u914D\u7F6E\u5931\u8D25");}else m.default.error("\u7F16\u8F91S3\u914D\u7F6E\u5931\u8D25\uFF1A\u7F3A\u5C11\u914D\u7F6EID");}catch(e){m.default.error("\u7F16\u8F91S3\u914D\u7F6E\u5931\u8D25");}},f=async e=>{try{let a=await (0,q.deleteS3Storage)(e);a.success?(m.default.success("\u5220\u9664S3\u914D\u7F6E\u6210\u529F"),n.current&&n.current.reload()):m.default.error(a.message||"\u5220\u9664S3\u914D\u7F6E\u5931\u8D25");}catch(e){m.default.error("\u5220\u9664S3\u914D\u7F6E\u5931\u8D25");}},M=e=>{t(e),a(!0);},y=[{title:r.formatMessage({id:"pages.s3Management.columnName"}),dataIndex:"s3Name",key:"s3Name",valueType:"text",sorter:!0,hideInSearch:!1},{title:r.formatMessage({id:"pages.s3Management.columnEndpoint"}),dataIndex:"endpoint",key:"endpoint",valueType:"text",hideInSearch:!0},{title:r.formatMessage({id:"pages.s3Management.columnAccessKey"}),dataIndex:"accessKey",key:"accessKey",valueType:"text",hideInSearch:!0},{title:r.formatMessage({id:"pages.s3Management.columnBucket"}),dataIndex:"bucket",key:"bucket",valueType:"text",hideInSearch:!0},{title:r.formatMessage({id:"pages.s3Management.columnRegion"}),dataIndex:"region",key:"region",valueType:"text",hideInSearch:!0},{title:r.formatMessage({id:"pages.s3Management.columnAction"}),valueType:"option",render:(e,a)=>(0,l.jsxs)(g.default,{children:[(0,l.jsx)(i.default,{type:"link",icon:(0,l.jsx)(x.default,{}),onClick:()=>M(a),children:r.formatMessage({id:"pages.s3Management.editButton"})}),(0,l.jsx)(p.default,{title:r.formatMessage({id:"pages.s3Management.deleteConfirmTitle"}),onConfirm:()=>f(a.id),okText:r.formatMessage({id:"pages.common.confirm"}),cancelText:r.formatMessage({id:"pages.common.cancel"}),children:(0,l.jsx)(i.default,{type:"link",danger:!0,icon:(0,l.jsx)(S.default,{}),children:r.formatMessage({id:"pages.s3Management.deleteButton"})})})]})}];return(0,l.jsxs)("div",{children:[(0,l.jsx)(g.default,{style:{marginBottom:16},children:(0,l.jsx)(i.default,{type:"primary",icon:(0,l.jsx)(h.default,{}),onClick:()=>{t(null),a(!0);},children:r.formatMessage({id:"pages.s3Management.addButton"})})}),(0,l.jsx)(j.ProTable,{columns:y,actionRef:n,request:c,rowKey:"id",pagination:{pageSize:10},search:{labelWidth:"auto"},options:{setting:{listsHeight:400}}}),(0,l.jsx)(w,{visible:e,initialValues:s,onFinish:s?u:o,onCancel:()=>a(!1)})]});};}}]);
//# sourceMappingURL=685bcb32-async.2326b4ca.js.map